<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="styles/timer.css">
    <link href="https://fonts.googleapis.com/css?family=Orbitron|Rajdhani&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Rajdhani&display=swap" rel="stylesheet">
    <style type="text/css">
      *{
        box-sizing: border-box;
      }

      body{
        background-color: black;
        color: white;
      }

      #game-wrapper{
        // hide this display: none;
      }
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 2px grey;
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb {
        background: red;
        border-radius: 10px;
      }
    </style>
    <script type="text/javascript"></script>
    <script type="text/javascript" src="javascript/game.js"></script>
    <script src ="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript">
      /*Page specific scripts*/
      $(document).ready(function(){
        $("#ShowStats").click(function(){
           $("#map").css("display","none");
            $("#hints").css("display","none");
           $("#playerStats").css("display","block");
        });
        $("#ShowMap").click(function(){
           $("#playerStats").css("display","none");
           $("#hints").css("display","none");
           $("#map").css("display","block");
        });
        $("#ShowHints").click(function(){
           $("#playerStats").css("display","none");
           $("#map").css("display","none");
           $("#hints").css("display","block");
        });


      });


      function allowDrop(ev) {
        ev.preventDefault();
      }

      function drag(ev) {
        ev.dataTransfer.setData("text", ev.target.id);
      }

      function drop(ev) {
        ev.preventDefault();
        var data = ev.dataTransfer.getData("text");
        if(event.target.tagName.toUpperCase() == "TD" && event.target.innerHTML == ''){
          ev.target.appendChild(document.getElementById(data));
          pickUpItems(player.currentRoom, data.split("_")[0],true);
        }
        else{
          document.getElementById('text-display').innerHTML += "<br> <span id='userTextWrong'>>Slot is already taken</span>";
          var elem = document.getElementById('text-display');
          elem.scrollTop = elem.scrollHeight;
        }
      }

      var currentTimeout = false;
      function displayInfo(ev){
        if(getDetailsOfItem(ev.src)){
          currentTimeout = false;
          var imgElement = document.getElementById('hoverImg');
          imgElement.src = ev.src;
          imgElement.style.opacity = '1';
        }
      }

      function hideInfo(ev){
        var src = ev.src;
        currentTimeout = true;
        setTimeout(function () { //add a timeout
          if(document.getElementById('hoverImg').src == src && currentTimeout){
            //if the hovered item hasnt changed revert back to default state
            var imgElement = document.getElementById('hoverImg');
            imgElement.src = ''; imgElement.alt = ''; imgElement.style.opacity = '0.2';
            document.getElementById('hoverInfo').innerHTML = 'Hover over an item for info here';
          }
        }, 900);
      }
    </script>

    <script type="text/javascript" src="javascript/combat.js"></script>

    <script type="text/javascript" src="javascript/timer.js"></script>
    <link rel="stylesheet" href="styles/gameWrapper.css">
    <link rel="stylesheet" href="styles/combatWrapper.css">
  </head>
  <body onload="gameStart();">
  <body>
    <div id="wrapper">
      <div id="settings-wrapper">
          <button type="button" style="float:right; cursor:pointer;" onclick="combatSetup();">Test combat</button>
          <button type="button" style="float:right; cursor:pointer;" onclick="pause();" id="pausebtn">Pause Game</button>

          <!--just putting timer in here for 'time' being (FUCK OFF DAVID (LUKE))-->
          <script>
            timerOperation();
          </script>
      </div>
      <br>
      <div id="container">
        <div id="userInput">
          <div id="textbox">
            <div id="text-display" class="text">
            </div>
            <div id = "easyButtons">
              <div id="compass">
                <div class="buttonsContainer">
                  <div id="compassRow">
                    <div id="left" class="cellAnimation">></div>
                    <div id="left"><button type="button" name="north" class="compassButtons" onclick="move('north');" id ="north">North</button></div>
                    <div id="left" class="cellAnimation"><</div>
                  </div>
                  <div id="compassRow">
                    <div id="left"><button type="button" name="west" class="compassButtons" onclick="move('west');" id ="west">West</button></div>
                    <div id="imageLeft"><img src="images/compass idea.png" alt="compass"></div>
                    <div id="left"><button type="button" name="east" class="compassButtons" onclick="move('east');" id ="east">East</button></div>
                  </div>
                  <div id="compassRow">
                    <div id="left" class="cellAnimation">></div>
                    <div id="left"><button type="button" name="south" class="compassButtons" onclick="move('south');" id ="south">South</button></div>
                    <div id="left" class="cellAnimation"><</div>
                  </div>
                </div>
              </div>
              <div id="quickButtons">
                <div><button type="button" name="Look" class="utilityButtons" onclick="outputCurrentRoomExits();">Look</button></div>
                <br>
                <div><button type="button" name="Search" class="utilityButtons" onclick="search(player.currentRoom);">Search</button></div>
              </div>
            </div>
            <br>
            <input type="text" class="input" name="cmd" placeholder="Enter your action" style="width:80%; color: #27910E;" id = "gameInput" onkeypress="if (event.keyCode === 13) document.getElementById('gameInputButton').click()">
            <button type="button" name="button" style="float:right; width:17%; height: 58px;" id = "gameInputButton" onclick="commandInput();">></button>
          </div>
        </div>
        <div id="playerContainer">

          <div id="statsContainer">
                 <div id="mapHeader">
                   <h1 id="currentRoomDisplay" class="text" style="border-bottom:2px solid #4edaf9">>Current Room: </h1>
                 </div>
                 <div id="map">
                     <img id="gameMap" src="images/gameMap.png" alt="This is the game map"style='height: 80%; width: 80%; object-fit: contain'>
                 </div>
                 <div id="hints" style="display:none; border-style:solid;">
                   <p style="font-weight:bold;font-size:1.4vw;">HINTS</p>
                   <ul>
                     <li>To pick up items, type pick up followed by the item name E.g "pick up ******".</li>
                     <li>You can search a room for items by typing "search" or clicking the search button. Nearby items will then be displayed to you.</li>
                     <li>Exits in the current room can be output to you by typing "look" or by clicking the look button.</li>
                     <li>To equip a weapon, type equip followed by the weapn name E.g "equip ******".The item will appear in the stats tab along with your ammo count.</li>
                     <li>To drop items, type drop followed by the item name E.g "drop ******".The item will stay in the room you dropped it in.</li>
                     <li></li>
                     <li></li>
                     <li></li>
                    <li></li>
                  </ul>
                 </div>
                 <div id="playerStats" style="display:none;">
                   <div id="playerProfile">
                        <div id=playerCharStat>
                          <img style=" float:left; min-width:35%; min-height:35%; max-height:100%; max-width:100%;" id="playerImg" src="images/playerIcon.jpg" alt="player image"></img>
                        </div>
                        <div id=playerInfoStat>
                          <p style="margin:0; text-align:left;"id="playerNameStat">Name:</p>
                          <p style="margin:0; text-align:left; "id="playerClassStat">Occupation:</p>
                        </div>
                  </div>

                    <div id="playerStatus">
                      <div id="playerHealthStats">
                        <p style="margin:0;" id="healthStat">Health:</p>
                        <div id="playerHealth">
                            <div id="healthBar"></div>
                        </div>
                        <button onclick="useItem('health kit')" id="healthKitBtn"style=" cursor:pointer ;margin-top:5px;height:15%; width:46%;">Use Health Kit</button>
                        <button onclick="useItem('health pack')"id="healthPackBtn" style=" cursor:pointer; margin-top:5px; height:15%; width:50%;">Use Health Pack</button>
                      </div>
                      <div id="playerWeaponStatus">
                        <p style="margin:0;padding:5px;"id="currentWeapon">Equipped Weapon:</p>
                        <div style="position:relative; bottom:30px;">
                          <p style="margin:0;"id="currentWeaponMag">/</p>
                          <button  onclick="reload();"id="reloadBtn"style="  cursor:pointer; margin-top:5px; height:35%; width:35%;" >Reload</button>
                          <img style="height:60%; width:55%;" id= "equippedWeaponImg" src="images/emptyinventoryslot.png" alt="Empty Weapon Slot"></img>
                        </div>
                      </div>
                   </div>
                   <div id="playerConsumables">
                      <div id="playerEnergyCellsStat">
                          <img style="height:40%; width:40%;"id="energyCellsStat" src="images/energycellStat.png" alt="Energy cell image"></img>
                          <p style="float:right;margin:0;"id="energyCellCount">x 0</p>
                      </div>
                      <div id="playerHealthPackStat">
                          <img style=" height:40%; width:40%;"id ="healthPackStat" src="images/healthPackStat.png" alt="image of a health pack"></img>
                          <p style="float:right;margin:0;"id="healthPackCount">x 0</p>
                      </div>
                      <div id="playerHealthKitStat">
                          <img style=" height:40%; width:40%;" id="healthKitStat" src="images/healthkitStat.png" alt="image of a health kit"></img>
                          <p style="float:right;margin:0;"id="healthKitCount">x 0</p>
                      </div>
                  </div>

              </div>
                <div id="buttonStat">
                  <button style="cursor:pointer;" id="ShowStats">Stats</button>
                  <button style="cursor:pointer;"id="ShowMap">Map</button>
                  <button style="cursor:pointer;" id="ShowHints">Hints</button>
                </div>
                  <div id="timerStat">
                      <span style="margin:0;" class="blinking" id="timer">Time remaining: 5:00</span>
                  </div>
                 <div id="objectivesStat">
                   <h3 style="margin:0;">Objectives:</h3>
                   <hr>
                   <ul style="margin:0;">
                     <li id="objective">Objective 1</li>
                   </ul>
                 </div>
        </div>
        <div id="playerInventory">
          <div id="inventory">
            <div id="inventoryHeader">
                <h1>Inventory</h1>
            </div>
              <table>
                <tr>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                </tr>
                <tr>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                  <td ondrop='drop(event)' ondragover='allowDrop(event)'></td>
                </tr>
              </table>
          </div>
          <div id="other1">


            <div id="inventoryHeader">
                <h1>Nearby Pickups</h1>
            </div>
            <table>
              <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </table>

            <img src="" alt="" id="hoverImg">
            <h3 id="hoverInfo">Hover over an item for info here</h3>

          </div>
        </div>
      </div>
      </div>
      <div id="combat-wrapper" class="hideMe">
        <div id="player1">
          <img src="images/playerIcon.jpg" alt="Player 1" class="playerImg">
          <div class="playerbox-info">
            <div class="healthbar" id="healthBar1"><div id="PlayerHB"></div>
            </div>
            <h1 id="player1Name" class="player-name">Player 1</h1>
            <h1 id="health1" class="player-health">100HP</h2>
          </div>
        </div>
        <div id="round-timer">
          <h1 id="countdownTimer">10:00</h1>
        </div>
        <div id="player2">
          <img src="images/playerIcon.jpg" alt="Player 2" class="playerImg">
          <div class="playerbox-info">
            <div class="healthbar" id="healthBar2"> <div id="EnemyHB"></div> </div>
            <h1 id="player2Name" class="player-name">Enemy</h1>
            <h1 id="health2" class="player-health">100HP</h2>
          </div>
        </div>
     <h1 id="healthLost" class="hideMe">Lost 20 health..</h1>
     <h1 id="damageGiven" class="hideMe">Damaged for 35..</h1>
     <div id="gameinstructions">
       <h1 class="combatHeader">Combat Instructions</h1>
       <ul>
         <li>Select desired combat type</li>
         <li>Drag weapon from inventory to weapon slot to change it</li>
         <li>Type in the hitbox and press enter to finish your turn</li>
         <li>The faster you complete your turn the more damage you will deal</li>
       </ul>
     </div>
     <div id="hitbox-display"  class="hideMe">
        <h1 class="combatHeader">Hitboxes</h1>
        <ul>
          <li>Head</li>
          <li>Chest</li>
          <li>Stomach</li>
          <li>Arms</li>
          <li>Legs</li>
          <li>Feet</li>
        </ul>
     </div>
     <div id="combatBox" class="hideMe">
       <div id="combat-main">
         <h1 class="combatHeader">Combat</h1>

         <input type="radio" name="Attack" value="Attack1" class="combatAction">
         <label for="" class="combatLabel">Aim</label>
         <input type="radio" name="Attack" value="Attack2" class="combatAction">
         <label for="" class="combatLabel">Charge enemy</label>
         <input type="radio" name="Attack" value="TakeCover" class="combatAction">
         <label for="" class="combatLabel">Take Cover</label>
         <div id="combat-col1">
           <h2>Aimpoint:</h2>
           <input type="text" name="hitbox" placeholder="hitbox" id="hitbox-input" onkeypress="if (event.keyCode === 13) exectuteCombat();">
         </div>
         <div id="combat-col2">
            <h2 id="weaponText">Weapon: </h2> <img src="images/itemPlaceholder.png" alt="Empty Slot" class="weaponPlaceholder">
         </div>
       </div>
       <div id="combat-inventory">
           <h1 class="combatHeader">Avaliable Weapons</h1>
           <table cellspacing="10">
             <tr>
               <td> <img src="images/itemPlaceholder.png" alt="Empty Slot" class="inventoryItem"> </td>
               <td> <img src="images/itemPlaceholder.png" alt="Empty Slot" class="inventoryItem"> </td>
               <td> <img src="images/itemPlaceholder.png" alt="Empty Slot" class="inventoryItem"> </td>
             </tr>
           </table>
       </div>
     </div>
     <div id="overviewBox">
         <button type="submit" name="button" onclick="nextRound();">Start Combat</button>
         <div id="overview-container" class="hideMe">
           <h1 class="combatHeader" id="turnOverview-header">Turn Overview</h1>
           <p id="turnOverviewText">
             During this turn you took <span id="stat-damageTaken">24</span> damage from <span class="enemyName">enemy</span>
             and dealt <span id="stat-damageGiven">50</span> damage in return to <span class="enemyName">enemy</span>.
           </p>
         </div>
      </div>
    </div>
  </div>
  <div id="pauseContainer" class="hideMe">
      <h1>Paused!</h3>
      <hr style="width:80%;">
      <button type="button" onclick="pause();" id="pausebtn">Unpause Game</button>
  </div>
  </body>
</html>
